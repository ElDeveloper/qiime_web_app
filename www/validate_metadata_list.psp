<%
__author__ = "Doug Wendel"
__copyright__ = "Copyright 2009-2010, Qiime Web Analysis"
__credits__ = ["Doug Wendel"]
__license__ = "GPL"
__version__ = "1.0.0.dev"
__maintainer__ = ["Doug Wendel", "Jesse Stombaugh"]
__email__ = "wendel@colorado.edu"
__status__ = "Development"
%>

<%@ include file="header.psp" %>

<script type="text/javascript" src="js/template.js"></script>

<h2>Metadata Validation</h2>

<a href="#" onclick="displayErrorCount(); return false;">Show Error Count</a>

<form target="_top" name="metadata_form" id="metadata_form" method="post" action="fusebox.psp">
<input type="hidden" id="page" name="page" value="submit_corrected_metadata.psp"/>

<%
from metadata_table import *

templates = sess["templates"]
if templates != None:
    error_count = 0
    
    for template in templates:
        req.write('<h3> Results for file: ' + os.path.basename(template) + '</h3>')
        table = MetadataTable(template)
        htmlTable, errors = table.printHTMLTable()
        error_count += errors
        req.write(htmlTable)
        
    req.write('<p/>')
    #req.write('<input type="hidden" id="error_count" value="%s"\n' % (error_count))
    
    req.write('<script type="text/javascript">\n')
    req.write('var error_count = %s;\n' % (error_count))
    req.write('</script>\n')

%>

<p/>
<input type="submit" id="metadata_submit" value="Submit Metadata" disabled><br/>
<p style="font-size:10px">(Fix errors above to enable submit button)</p>

<p/>
</form>

<%@ include file="footer.psp" %>
